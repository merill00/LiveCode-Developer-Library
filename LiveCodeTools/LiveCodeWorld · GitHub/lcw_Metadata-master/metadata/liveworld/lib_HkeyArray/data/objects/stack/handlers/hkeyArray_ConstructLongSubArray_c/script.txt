command hkeyArray_ConstructLongSubArray shortHKey, hObject, shortHkeyArray, @longHkeyArray, pSetName
   /*
   This is a better more readable format than the one generated by the simple walk.
   Hkeys without children are listed as keys, so you can see them.
   Also array_AllNodes (hkeyArray) = keys (hkeyArray) which makes things faster
   They shoudlgraph the same.
   */
   local longChildKeys
   
   put item 1 of shortHKey into callName
   put item 2 of shortHKey into callType
   
   put hkey_Construct (callName, callType, hObject, 1) into longHkey
   
   if longHkey is among the keys of longHkeyArray then
      -- already indexed (don't recurse)
      return empty
   end if
   
   put shortHkeyArray [shortHKey] into shortChildKeys
   put hkey_ShortToLongCalls (shortChildKey, hObject, pSetName) into longChildKeys
   put longChildKeys into longHkeyArray [longHkey]
   
   -- now recurse
   repeat for each line childHkey in longChildKeys
      hkey_Deconstruct childHkey, childName, childType, childObject, childNum
      put childName,childType into shortChildKey
      hkeyArray_ConstructLongSubArray shortChildKey, childObject, shortHkeyArray, longHkeyArray, pSetName
   end repeat
end hkeyArray_ConstructLongSubArray